!function(){"use strict";function a(a){var b="ctrl",c={authenticated:["$q","auth",function(a,b){return b.isAuthenticated()?!0:a.reject("not authorised")}]};a.when("/",{templateUrl:"views/main.html",controller:"HomeController",controllerAs:b}).when("/register",{templateUrl:"views/identity/register.html",controller:"RegisterController",controllerAs:b}).when("/login",{templateUrl:"views/identity/login.html",controller:"LoginController",controllerAs:b}).when("/me",{templateUrl:"views/user/profile.html",controller:"LoginController",controllerAs:b}).when("/quizzes",{templateUrl:"views/quiz/quizzes.html",controller:"QuizzesController",controllerAs:b}).when("/quizzes/add",{templateUrl:"views/quiz/add-quiz.html",controller:"CreateQuizController",controllerAs:b,resove:c.authenticated}).when("/quizzes/edit",{templateUrl:"views/quiz/add-quiz.html",controller:"UpdateQuizController",controllerAs:b,resove:c.authenticated}).when("/quizzes/solve/:id",{templateUrl:"views/quiz/solve-quiz.html",controller:"SolveQuizController",controllerAs:b}).when("/quizzes/result",{templateUrl:"views/quiz/result.html",controller:"ResultController",controllerAs:b}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:b}).otherwise({redirectTo:"/"})}function b(a,b,c,d,e){c.$on("$routeChangeError",function(a,b,c,e){"not authorised"===e&&d.path("/")}),e.isAuthenticated()&&(a.defaults.headers.common.Authorization="Bearer "+b.get("authentication"),e.getIdentity())}angular.module("quizProjectApp.services",[]),angular.module("quizProjectApp.filters",[]),angular.module("quizProjectApp.controllers",["quizProjectApp.services"]),angular.module("quizProjectApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ngStorage","ui.bootstrap","quizProjectApp.filters","quizProjectApp.controllers"]).config(["$routeProvider",a]).run(["$http","$cookies","$rootScope","$location","auth",b]).constant("baseUrl","http://localhost:42252/")}(),angular.module("quizProjectApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),function(){"use strict";function a(a,b,c){function d(){console.log("waiting for login..."),b.getUser().then(function(a){e.currentUserGlobal=a,console.log("ready")})}var e=this;e.logout=function(){console.log("Logging out..."),c.logout(),e.currentUserGlobal=null,d(),a.path("/")},d()}angular.module("quizProjectApp.controllers").controller("MainController",["$location","identity","auth",a])}(),function(){"use strict";function a(){return function(a,b,c){b=+b,c=+c;var d=(b-1)*c,e=b*c;return a.slice(d,e)}}angular.module("quizProjectApp.filters").filter("paging",[a])}(),function(){"use strict";function a(){var a=this;a.hi="HI!"}angular.module("quizProjectApp.controllers").controller("HomeController",[a])}(),function(){"use strict";var a=function(a,b,c,d,e){var f="authentication",g=function(c){var d=b.defer();return a.post(e+"api/account/register",c).then(function(a){console.log(a),d.resolve(!0)},function(a){d.reject(a)}),d.promise},h=function(d){var g=b.defer(),h="grant_type=password&username="+(d.username||"")+"&password="+(d.password||"");return a.post(e+"Token",h,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){var d=b.access_token,e=new Date;e.setHours(e.getHours()+72),c.put(f,d,{expires:e}),a.defaults.headers.common.Authorization="Bearer "+d,i().then(function(){g.resolve(b)})}).error(function(a){g.reject(a)}),g.promise},i=function(){var c=b.defer();return a.get(e+"api/Account/UserInfo").success(function(a){d.setUser(a),c.resolve(a)}),c.promise};return{register:g,login:h,getIdentity:i,isAuthenticated:function(){return!!c.get(f)},logout:function(){console.log("logging out"),c.remove(f),a.defaults.headers.common.Authorization=null,d.removeUser()}}};angular.module("quizProjectApp.services").factory("auth",["$http","$q","$cookies","identity","baseUrl",a])}(),function(){"use strict";var a=function(a){var b={},c=a.defer();return{getUser:function(){return this.isAuthenticated()?a.resolve(b):c.promise},isAuthenticated:function(){return 0!==Object.getOwnPropertyNames(b).length},setUser:function(a){console.log(a),b=a,c.resolve(a)},removeUser:function(){b={},c=a.defer()}}};angular.module("quizProjectApp.services").factory("identity",["$q",a])}(),function(){"use strict";function a(a,b){var c=this;c.login=function(c,d){d.$valid&&b.login(c).then(function(b){console.log(b),a.path("/")})}}angular.module("quizProjectApp.controllers").controller("LoginController",["$location","auth",a])}(),function(){"use strict";function a(a,b){var c=this;c.register=function(c,d){d.$valid&&b.register(c).then(function(){a.path("/")})}}angular.module("quizProjectApp.controllers").controller("RegisterController",["$location","auth",a])}(),function(){"use strict";function a(a,c){var d=this,e="";d.letters="abcdefghijk",c?(d.question=c,e=JSON.stringify(c)):d.question={title:"",answers:[]},d.ok=function(){e?a.close(null):a.close(d.question)},d.cancel=function(){e&&(b(c,e),console.log(c)),a.dismiss("cancel")},d.addAnswer=function(){d.question.answers.push({text:""})},d.removeAnswer=function(a){d.question.answers.splice(a,1)},d.markCorrect=function(a){d.question.answers.forEach(function(b,c){b.isCorrect=c===a})},d.hasCorrect=function(){return d.question.answers.some(function(a){return a.isCorrect})}}function b(a,b){var c,d=JSON.parse(b);for(c in d)a[c]=d[c]}angular.module("quizProjectApp.controllers").controller("AddQuestionController",["$uibModalInstance","items",a])}(),function(){"use strict";function a(a,c,d,e,f){var g=this;a.init=function(){console.log("parent init.."),d.quiz=d.quiz||angular.copy(b),a.quiz=d.quiz},g.addQuiz=function(b,c){console.log("adding quiz..."),console.log(b),f.addQuiz(angular.copy(b)).then(function(b){console.log("quiz added (id: %s)",b),a.resetForm(c),e.path("/quizzes")})},a.resetForm=function(c){c.$setPristine(),c.$setUntouched(),d.quiz=angular.copy(b),a.quiz=d.quiz},g.removeQuestion=function(b){a.quiz.questions.splice(b,1)},g.getCategories=function(a){return f.getCategories(a)},g.openQuesitonMenu=function(b){var d=c.open({animation:!0,templateUrl:"views/quiz/add-question.html",controller:"AddQuestionController",controllerAs:"ctrl",resolve:{items:b}});d.result.then(function(b){null!==b&&a.quiz.questions.push(b)},function(){console.log("Modal dismissed at: "+new Date)})},a.init()}var b={title:"",description:"",category:"",completedCounter:0,questions:[]};angular.module("quizProjectApp.controllers").controller("CreateQuizController",["$scope","$uibModal","$sessionStorage","$location","QuizDataService",a])}(),function(){"use strict";function a(a,c,d){var e=this;this.addQuiz=function(b){var e=c.defer();return a.post(d+"api/quizzes",b).then(function(a){console.log(a),e.resolve(a.data)},function(a){e.reject(a)}),e.promise},this.removeQuiz=function(b){var e=c.defer();return console.log("deleting..."),a["delete"](d+"api/quizzes/"+b).then(function(a){console.log("deleted"),console.log(a),e.resolve(a)},function(a){e.reject(a)}),e.promise},this.getCategories=function(b){if(b){var e=c.defer();return a.get(d+"api/quizzes/categories?pattern="+b).then(function(a){e.resolve(a.data)}),e.promise}},this.getQuizzes=function(e){var f=c.defer(),g=d+"api/quizzes";return null!==e&&(g+="?"+b(e),console.log(g)),a.get(g).then(function(a){console.log(a),f.resolve(a.data)},function(a){f.reject(a)}),f.promise},this.getQuiz=function(b){var e=c.defer();return a.get(d+"api/quizzes/"+b).then(function(a){e.resolve(a.data)},function(a){e.reject(a)}),e.promise},this.submitSolution=function(b){var f=c.defer();return a.post(d+"api/quizzes/solve",b).then(function(a){e.resultResponse=a.data,f.resolve(a.data)},function(a){f.reject(a)}),f.promise},this.resultResponse={}}function b(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}angular.module("quizProjectApp.services").service("QuizDataService",["$http","$q","baseUrl",a])}(),function(){"use strict";function a(a,b,c,d,e){var f=this;f.init=function(){d.getQuizzes().then(function(b){a.$storage=b}),e.getUser().then(function(b){a.userDetails=b})},f.editActive=function(){var a=f.getActiveQuiz();console.log(a),b.editQuiz=a,c.path("/quizzes/edit")},f.deleteActive=function(){var b=0;a.$storage.find(function(a,c){return b=c,a.active}),d.removeQuiz(a.$storage[b].id).then(function(){a.$storage.splice(b,1)})},f.solveAlctive=function(){var a=f.getActiveQuiz();b.solveQuiz=a,c.path("/quizzes/solve/"+a.id)},f.getActiveQuiz=function(){var b=a.$storage.filter(function(a){return a.active})[0];return b},a.noWrapSlides=!1,f.init()}angular.module("quizProjectApp.controllers").controller("QuizzesController",["$scope","$sessionStorage","$location","QuizDataService","identity",a])}(),function(){"use strict";function a(a){if(!a.resultResponse.title)throw new Error("There is no solved quiz to display");var b=this;b.result=a.resultResponse,b.getScore=function(){var a=(b.result.totalQuestions-b.result.wrongAnswers.length)/b.result.totalQuestions*100;return Math.round(a)}}angular.module("quizProjectApp.controllers").controller("ResultController",["QuizDataService",a])}(),function(){"use strict";function a(a,b,c,d,e){var f=this;c.solveQuiz=c.solveQuiz||e.get(b.id),f.quiz=c.solveQuiz,f.questionsPerPage=2,f.currentPage=1,f.setQuestions=function(a){f.questionsPerPage=a,console.log(a)},f.pageChanged=function(){},f.progress=function(){var a=f.quiz.questions.length,b=f.quiz.questions.filter(function(a){return void 0!==a.selected}).length,c=b/a*100;return c},f.submit=function(a){var b={id:a.id,questions:a.questions.filter(function(a){return{title:a.title,selectedAnswer:a.selected}})};e.submitSolution(b).then(function(){d.path("/quizzes/result")})},f.pageChanged()}angular.module("quizProjectApp.controllers").controller("SolveQuizController",["$scope","$routeParams","$sessionStorage","$location","QuizDataService",a])}(),function(){"use strict";function a(a,b,c){angular.extend(this,c("CreateQuizController",{$scope:a})),a.init=function(){console.log("child init"),a.quiz=b.editQuiz},a.resetForm=function(c){c.$setPristine(),c.$setUntouched(),delete b.editQuiz,a.quiz={}},a.init()}angular.module("quizProjectApp.controllers").controller("UpdateQuizController",["$scope","$sessionStorage","$controller",a])}(),function(){"use strict";function a(){}angular.module("quizProjectApp.controllers").controller("ProfileController",[a])}();